sex_edu_inc$edu = as.factor(sex_edu_inc$edu)
sex_edu_inc$inc = as.factor(sex_edu_inc$inc)
sex_edu_inc$sex = as.factor(sex_edu_inc$sex)
sex_edu_inc = sex_edu_inc %>% filter(!is.na(inc),
sex_edu_inc = sex_edu_inc %>% filter(!is.na(inc),!is.na(edu),!is.na(sex))
ggplot(sex_edu_inc, aes(x=sex, fill = inc)) +
geom_bar() + facet_wrap( ~ edu, ncol=2)
ggplot(sex_edu_inc, aes(x=sex, fill = inc,group=inc)) +
geom_bar() + facet_wrap( ~ edu, ncol=2)
ggplot(sex_edu_inc, aes(x=sex, fill = inc,group=inc)) +
geom_bar() + facet_wrap( ~ edu, ncol=2)
ggplot(sex_edu_inc, aes(x=sex, fill = inc,group=sex)) +
geom_bar() + facet_wrap( ~ edu, ncol=2)
ggplot(sex_edu_inc, aes(x=sex, fill = inc)) +
geom_bar() + facet_wrap( ~ edu, ncol=2)
ggplot(sex_edu_inc, aes(x=sex, fill = inc)) +
geom_bar(alpha = 0.5, position = 'identity') + facet_wrap( ~ edu, ncol=2)
ggplot(sex_edu_inc, aes(x=sex, fill = inc,group=inc)) +
geom_bar(alpha = 0.5, position = 'identity') + facet_wrap( ~ edu, ncol=2)
ggplot(sex_edu_inc, aes(x=sex, fill = inc,group=inc)) +
geom_bar(alpha = 0.5, position = 'fill') + facet_wrap( ~ edu, ncol=2)
ggplot(sex_edu_inc, aes(x=sex, fill = inc,group=inc)) +
geom_bar(position = 'fill') + facet_wrap( ~ edu, ncol=2)
ggplot(sex_edu_inc, aes(x=sex, fill = inc,group=inc)) +
geom_bar(position = 'x') + facet_wrap( ~ edu, ncol=2)
ggplot(sex_edu_inc, aes(x=sex, fill = inc,group=inc)) +
geom_bar(position = 'fill') + facet_wrap( ~ edu, ncol=2)
?geom_bar
ggplot(sex_edu_inc, aes(x=sex, fill = inc,group=inc)) +
geom_bar(position = 'stack') + facet_wrap( ~ edu, ncol=2)
ggplot(sex_edu_inc, aes(x=sex, fill = inc,group=inc)) +
geom_bar(position = 'fill') + facet_wrap( ~ edu, ncol=2)
men_phy_inc = data.frame(inc = brfss2013$income2,men=brfss2013$menthlth,phy=brfss2013$physhlth)
sex_edu_inc = sex_edu_inc %>% filter(!is.na(inc),!is.na(men),!is.na(phy))
men_phy_inc = data.frame(inc = brfss2013$income2,men=brfss2013$menthlth,phy=brfss2013$physhlth)
men_phy_inc = men_phy_inc %>% filter(!is.na(inc),!is.na(men),!is.na(phy))
men_phy_inc$inc = as.factor(men_phy_inc$inc)
ggplot(men_phy_inc,aes(x=phy,y=men,colour=inc,shape=inc))+geom_point(alpha=0.5)
ggplot(men_phy_inc,aes(x=phy,y=men,colour=inc))+  geom_point(alpha=0.3) + facet_wrap( ~ inc, ncol=2)
ggplot(men_phy_inc,aes(x=phy,y=men,colour=inc))+  geom_point(alpha=0.3) + facet_wrap( ~ inc, ncol=2)
gr = men_phy_inc %>% group_by("phy","inc")
gr
gr = men_phy_inc %>% group_by(phy,inc)
gr
gr
gr = men_phy_inc %>% group_by(phy,inc)
gr
gr = men_phy_inc %>% group_by(inc) %>% summarise(x_bar = mean())
gr = men_phy_inc %>% group_by(inc) %>% summarise(x_bar = mean(men))
gr
gr = men_phy_inc %>% group_by(phy) %>% summarise(x_bar = mean(men))
gr
gr = men_phy_inc %>% group_by(phy,inc) %>% summarise(x_bar = mean(men))
gr
gr = men_phy_inc %>% group_by(phy,inc) %>% summarise(x_bar_men = mean(men))
gr = men_phy_inc %>% group_by(phy,inc) %>% summarise(mean_men = mean(men))
grgrgrgrggplot(gr,aes(x=phy,y=mean_men,colour=inc))+  geom_point(alpha=0.3) + facet_wrap( ~ inc, ncol=2)
ggplot(gr,aes(x=phy,y=mean_men,colour=inc))+  geom_point(alpha=0.3) + facet_wrap( ~ inc, ncol=2)
gym_wei_hei = data.frame(gym = brfss2013$exerany2,wei=brfss2013$weight2,hei=brfss2013$height3)
gym_wei_hei = data.frame(gym = brfss2013$exerany2,wei=brfss2013$weight2,hei=brfss2013$height3)
gym_wei_hei = gym_wei_hei %>% filter(!is.na(gym),!is.na(wei),!is.na(hei))
bmi = 703*gym_wei_hei$wei/gym_wei_hei$hei^2
gym_wei_hei$we
gym_wei_hei$wei
is.factor(gym_wei_hei$wei)
gym_wei_hei = data.frame(gym = brfss2013$exerany2,wei=as.numeric(brfss2013$weight2),hei=as.numeric(brfss2013$height3)
gym_wei_hei = gym_wei_hei %>% filter(!is.na(gym),!is.na(wei),!is.na(hei))
bmi = 703*gym_wei_hei$wei/gym_wei_hei$hei^2
gym_wei_hei = data.frame(gym = brfss2013$exerany2,wei=as.numeric(brfss2013$weight2),hei=as.numeric(brfss2013$height3)
gym_wei_hei = gym_wei_hei %>% filter(!is.na(gym),!is.na(wei),!is.na(hei))
bmi = 703*gym_wei_hei$wei/gym_wei_hei$hei^2
gym_wei_hei = data.frame(gym = brfss2013$exerany2,wei=as.numeric(brfss2013$weight2),hei=as.numeric(brfss2013$height3)
)
gym_wei_hei = data.frame(gym = brfss2013$exerany2,wei=as.numeric(brfss2013$weight2),hei=as.numeric(brfss2013$height3))
filter
gym_wei_hei = gym_wei_hei %>% filter(!is.na(gym),!is.na(wei),!is.na(hei))
bmi = 703*gym_wei_hei$wei/gym_wei_hei$hei^2
bmi
gym_wei_hei$wei
gym_wei_hei$hei^2
bmi = 703*gym_wei_hei$wei/gym_wei_hei$hei^2
gym_wei_hei
bmi = 703*gym_wei_hei$wei/(gym_wei_hei$hei/10)^2
b,i
bmi
gym_wei_hei = data.frame(gym = brfss2013$exerany2,wei=as.numeric(brfss2013$weight2),hei=as.numeric(brfss2013$height3)/10)
g
gym_wei_hei = gym_wei_hei %>% filter(!is.na(gym),!is.na(wei),!is.na(hei))
gym_wei_hei = gym_wei_hei $>$ mutate(bmi = 703*gym_wei_hei$wei/(gym_wei_hei$hei)^2)
gym_wei_hei = gym_wei_hei %>% mutate(bmi = 703*gym_wei_hei$wei/(gym_wei_hei$hei)^2)
gym_wei_hei
length(bmi)
body_cat = factor(rep(NA,length(bmi)),levels = c("Underweight","Normal","Overweight","Obese","Moderately Obese","Severely/Morbidly Obese"))
body_cat
body_cat[gym_wei_hei$bmi>18.5 and gym_wei_hei$bmi<=24.9] = "Normal"
body_cat[gym_wei_hei$bmi>18.5 & gym_wei_hei$bmi<=24.9] = "Normal"
body_cat
body_cat = factor(rep(NA,length(bmi)),levels = c("Underweight","Normal","Overweight","Obese","Moderately Obese","Severely/Morbidly Obese"))
body_cat[gym_wei_hei$bmi<=18.5] = "Underweight"
body_cat[gym_wei_hei$bmi>18.5 & gym_wei_hei$bmi<=25] = "Normal"
body_cat[gym_wei_hei$bmi>25 & gym_wei_hei$bmi<=27] = "Overweight"
body_cat[gym_wei_hei$bmi>27 & gym_wei_hei$bmi<=35] = "Obese/Moderately obese"
body_cat[gym_wei_hei$bmi>35] = "Severely/Morbidly obese"
body_cat[gym_wei_hei$bmi<=18.5] = "Underweight"
body_cat = factor(rep(NA,length(bmi)),levels = c("Underweight","Normal","Overweight","Obese/Moderately Obese","Severely/Morbidly Obese"))
body_cat[gym_wei_hei$bmi<=18.5] = "Underweight"
body_cat[gym_wei_hei$bmi>18.5 & gym_wei_hei$bmi<=25] = "Normal"
body_cat[gym_wei_hei$bmi>25 & gym_wei_hei$bmi<=27] = "Overweight"
body_cat[gym_wei_hei$bmi>35] = "Severely/Morbidly obese"
body_cat[gym_wei_hei$bmi>27 & gym_wei_hei$bmi<=35] = "Obese/Moderately Obese"
body_cat[gym_wei_hei$bmi>35] = "Severely/Morbidly Obese"
body_cat
gym_wei_hei = gym_wei_hei %>% mutate(body_cat)
is.factor(gym)
is.factor(brfss2013$exerany2)
head(gym_wei_hei)
ggplot(gym_wei_hei,aes(x=gym,fill=body_cat))+geom_bar()
ggplot(gym_wei_hei,aes(x=gym,fill=body_cat))+geom_bar(position="fill")
gr
View(gr)
View(gr)
print(gr)
view(gr)
view
View(gr)
men_phy_sex = data.frame(sex = as.factor(brfss2013$sex),men=brfss2013$menthlth,phy=brfss2013$physhlth)
men_phy_sex = men_phy_sex %>% filter(!is.na(sex),!is.na(men),!is.na(phy))
gr = men_phy_sex %>% group_by(phy,sex) %>% summarise(mean_men = mean(men))
ggplot(gr,aes(x=phy,y=mean_men,colour=sex))+  geom_point(alpha=0.3) + facet_wrap( ~ sex, ncol=2)
View(sex_edu_inc)
View(men_phy_sex)
View(men_phy_sex)
View(gr)
print(gr)
gr_men = gr %>% filter(sex=="Male")
gr_men
gr_men = gr %>% group_by(sex)
gr_men
gr_men = gr %>% filter(sex=="Male")
gr_men
print(gr_men)
gr_men = gr %>% filter(sex=="Female")
gr_men = gr %>% filter(sex=="Male")
gr_fem = gr %>% filter(sex=="Female")
gr_fem
pkg = c("dplyr", "knitr", "devtools", "DT", "xtable")
new.pkg <- pkg[!(pkg %in% installed.packages())]
if (length(new.pkg)) {
install.packages(new.pkg, repos = "http://cran.rstudio.com")
}
library(ggplot2)
library(dplyr)
library(knitr)
library(DT)
library(xtable)
kable(joined_worst)
View(mtcars)
kable(gr_men)
print(xtable(gr_men)
)
print(gr_men, nrow=105,ncol=2)
print(gr_men, nrow=31)
print(gr_men, nrow=31)
print(gr_menm,top_n=31)
print(gr_men, top_n=31)
DT <- data.table(a = 1:1000)
print(DT, nrows = 100, topn = 4)
DT <- datatable(a = 1:1000)
options("max.print")
print(gr_fem)
options(dplyr.print_max)
dplyr.print_max
options(dplyr.print_max=1000)
print(gr_fem)
gr_print = data.frame(phy=brfss2013$physhlth,mean_men_male = gr%>%filter(sex==male)$mean_men)
gr_print = data.frame(phy=brfss2013$physhlth,mean_men_male = gr%>%filter(sex==male))
gr_print = data.frame(phy=brfss2013$physhlth,mean_men_male = gr%>%filter(sex=="Male"))
mean_men_male = gr%>%filter(sex=="Male")
mean_men_male
male = gr%>%filter(sex=="Male")
female = gr%>%filter(sex=="Female")
gr_print = data.frame(phy=mean_men_male$phy,mean_men_male = male$mean_men,
mean_men_female=female$mean_men)
gr_print
sex_edu_inc = data.frame(edu = as.factor(brfss2013$educa),inc=as.factor(brfss2013$income2),sex=as.factor(brfss2013$sex))
sex_edu_inc = sex_edu_inc %>% filter(!is.na(inc),!is.na(edu),!is.na(sex))
ggplot(sex_edu_inc, aes(x=sex, fill = inc,group=inc)) +
geom_bar(position = 'fill') + facet_wrap( ~ edu, ncol=2)
sex_edu_inc %>% group_by(sex,edu)%>%summarise(propo = prop.table(inc))
sex_edu_inc %>% group_by(sex,edu)%>%summarise(n = n())
sex_edu_inc %>% group_by(sex,edu)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
sex_edu_inc %>% group_by(sex,edu,inc)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
sex_edu_inc %>% group_by(sex,edu,inc)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
inc_twolevels = factor(rep(NA,length(sex_edu_inc$inc)),levels = c("Less than $35k","More than $35k"))
sex_edu_inc$inc%>%unique()
inc_twolevels = factor(rep(NA,length(sex_edu_inc$inc)),levels = c("Less than $25k","More than $25k"))
inc_twolevels[sex_edu_inc$inc == "Less than $75,000"|"$75,000 or more"|"Less than $50,000"|"Less than $35,000"]="More than $25k"
inc_twolevels = factor(rep(NA,length(sex_edu_inc$inc)),levels = c("Less than $25k","More than $25k"))
inc_twolevels[sex_edu_inc$inc == "Less than $75,000"|"$75,000 or more"|sex_edu_inc$inc == "Less than $50,000"
|sex_edu_inc$inc == "Less than $35,000"]="More than $25k"
inc_twolevels[sex_edu_inc$inc == "Less than $75,000"|sex_edu_inc$inc =="$75,000 or more"
|sex_edu_inc$inc == "Less than $50,000"|sex_edu_inc$inc == "Less than $35,000"]="More than $25k"
inc_twolevels[sex_edu_inc$inc == "Less than $25,000"|sex_edu_inc$inc == "Less than $20,000"
|sex_edu_inc$inc == "Less than $15,000"|sex_edu_inc$inc == "Less than $10,000"]="Less than $25k"
sex_edu_inc$inc%>%mutate(inc_twolevels)
sex_edu_inc%>%mutate(inc_twolevels)
sex_edu_inc = sex_edu_inc%>%mutate(inc_twolevels)
ggplot(sex_edu_inc, aes(x=sex, fill = inc,group=inc_twolevels)) +
geom_bar(position = 'fill') + facet_wrap( ~ edu, ncol=2)
sex_edu_inc
ggplot(sex_edu_inc, aes(x=sex, fill = inc_twolevels,group=inc_twolevels)) +
geom_bar(position = 'fill') + facet_wrap( ~ edu, ncol=2)
sex_edu_inc %>% group_by(sex,edu,inc_twolevels)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
sex_edu_inc %>% group_by(sex,edu,inc_twolevels)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
sex_edu_inc %>% group_by(sex,edu,inc_twolevels)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
pr = sex_edu_inc %>% group_by(sex,edu,inc_twolevels)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
View(pr)
View(pr)
pr = sex_edu_inc %>% group_by(edu,sex,inc_twolevels)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
View(pr)
pr = sex_edu_inc %>% group_by(sex,edu,inc_twolevels)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
View(pr)
View(pr)
pr = sex_edu_inc %>% group_by(edu,sex,inc_twolevels)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
View(pr)
sex_edu_inc = sex_edu_inc %>% group_by(edu,sex,inc_twolevels)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
print(data.frame(Edu = sex_edu_inc$edu,Sex = sex_edu_inc$sex,Percentage = sex_edu_inc$prop))
sex_edu_inc = data.frame(edu = as.factor(brfss2013$educa),inc=as.factor(brfss2013$income2),sex=as.factor(brfss2013$sex))
sex_edu_inc$edu[sex_edu_inc$edu="College 1 year to 3 years (Some college or technical school)"] = "College 1 year to 3 years"
sex_edu_inc$edu[sex_edu_inc$edu=="College 1 year to 3 years (Some college or technical school)"] = "College 1 year to 3 years"
sex_edu_inc$edu
sex_edu_inc$edu=="College 1 year to 3 years (Some college or technical school)"
sex_edu_inc$inc == "Less than $75,000"
sex_edu_inc = sex_edu_inc %>% filter(!is.na(inc),!is.na(edu),!is.na(sex))
sex_edu_inc$edu[sex_edu_inc$edu=="College 1 year to 3 years (Some college or technical school)"] = "College 1 year to 3 years"
sex_edu_inc$edu=="College 1 year to 3 years (Some college or technical school)"
sex_edu_inc %>% unique(edu)
sex_edu_inc %>% unique(edu)
unique(sex_edu_inc$edu)
sex_edu_inc$edu
sex_edu_inc$edu[sex_edu_inc$edu=="College 1 year to 3 years (Some college or technical school)"]
sex_edu_inc$edu[sex_edu_inc$edu=="College 1 year to 3 years (Some college or technical school)"]
sex_edu_inc$edu[sex_edu_inc$edu=="College 1 year to 3 years (Some college or technical school)"]
sex_edu_inc$edu[sex_edu_inc$edu=="College 1 year to 3 years (Some college or technical school)"] = "College 1 year to 3 years"
sex_edu_inc = data.frame(edu = as.factor(brfss2013$educa),inc=as.factor(brfss2013$income2),sex=as.factor(brfss2013$sex))
sex_edu_inc = sex_edu_inc %>% filter(!is.na(inc),!is.na(edu),!is.na(sex))
sex_edu_inc$edu[sex_edu_inc$edu=="College 1 year to 3 years (Some college or technical school)"] = "College 1 year to 3 years"
sex_edu_inc$edu[sex_edu_inc$edu=="College 1 year to 3 years (Some college or technical school)"] = "College 1 year to 3 years"
View(sex_edu_inc)
sex_edu_inc = data.frame(edu = as.factor(brfss2013$educa),inc=as.factor(brfss2013$income2),sex=as.factor(brfss2013$sex))
sex_edu_inc = sex_edu_inc %>% filter(!is.na(inc),!is.na(edu),!is.na(sex))
factor(sex_edu_inc)
brfss2013$educa[sbrfss2013$educa=="College 1 year to 3 years (Some college or technical school)"] = "College 1 year to 3 years"
brfss2013$educa[brfss2013$educa=="College 1 year to 3 years (Some college or technical school)"] = "College 1 year to 3 years"
load("brfss2013.RData")
levels(sex_edu_inc$edu)
levels(sex_edu_inc$edu) <- gsub("College 1 year to 3 years (Some college or technical school)","College 1 year to 3 years", levels(sex_edu_inc$edu))
ex_edu_inc = data.frame(edu = as.factor(brfss2013$educa),inc=as.factor(brfss2013$income2),sex=as.factor(brfss2013$sex))
sex_edu_inc = sex_edu_inc %>% filter(!is.na(inc),!is.na(edu),!is.na(sex))
levels(sex_edu_inc$edu) <- gsub("College 1 year to 3 years (Some college or technical school)","College 1 year to 3 years", levels(sex_edu_inc$edu))
inc_twolevels = factor(rep(NA,length(sex_edu_inc$inc)),levels = c("Less than $25k","More than $25k"))
inc_twolevels[sex_edu_inc$inc == "Less than $75,000"|sex_edu_inc$inc =="$75,000 or more"
|sex_edu_inc$inc == "Less than $50,000"|sex_edu_inc$inc == "Less than $35,000"]="More than $25k"
inc_twolevels[sex_edu_inc$inc == "Less than $25,000"|sex_edu_inc$inc == "Less than $20,000"
|sex_edu_inc$inc == "Less than $15,000"|sex_edu_inc$inc == "Less than $10,000"]="Less than $25k"
sex_edu_inc = sex_edu_inc%>%mutate(inc_twolevels)
sex_edu_inc = sex_edu_inc %>% group_by(edu,sex,inc_twolevels)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
print(data.frame(Edu = sex_edu_inc$edu,Sex = sex_edu_inc$sex,Percentage = sex_edu_inc$prop))
ggplot(sex_edu_inc, aes(x=sex, fill = inc_twolevels,group=inc_twolevels)) +
geom_bar(position = 'fill') + facet_wrap( ~ edu, ncol=2)
sex_edu_inc = data.frame(edu = as.factor(brfss2013$educa),inc=as.factor(brfss2013$income2),sex=as.factor(brfss2013$sex))
sex_edu_inc = sex_edu_inc %>% filter(!is.na(inc),!is.na(edu),!is.na(sex))
levels(sex_edu_inc$edu) = gsub("College 1 year to 3 years (Some college or technical school)","College 1 year to 3 years", levels(sex_edu_inc$edu))
View(sex_edu_inc)
View(sex_edu_inc)
sex_edu_inc = data.frame(edu = as.factor(brfss2013$educa),inc=as.factor(brfss2013$income2),sex=as.factor(brfss2013$sex))
sex_edu_inc = sex_edu_inc %>% filter(!is.na(inc),!is.na(edu),!is.na(sex))
levels(sex_edu_inc$edu)[levels(sex_edu_inc$edu)=="College 1 year to 3 years (Some college or technical school)"] = "College 1 year to 3 years"
View(sex_edu_inc)
ggplot(sex_edu_inc, aes(x=sex, fill = inc_twolevels,group=inc_twolevels)) +
geom_bar(position = 'fill') + facet_wrap( ~ edu, ncol=2)
sex_edu_inc = data.frame(edu = as.factor(brfss2013$educa),inc=as.factor(brfss2013$income2),sex=as.factor(brfss2013$sex))
sex_edu_inc = sex_edu_inc %>% filter(!is.na(inc),!is.na(edu),!is.na(sex))
levels(sex_edu_inc$edu)[levels(sex_edu_inc$edu)=="College 1 year to 3 years (Some college or technical school)"] = "College 1 year to 3 years"
inc_twolevels = factor(rep(NA,length(sex_edu_inc$inc)),levels = c("Less than $25k","More than $25k"))
inc_twolevels[sex_edu_inc$inc == "Less than $75,000"|sex_edu_inc$inc =="$75,000 or more"
|sex_edu_inc$inc == "Less than $50,000"|sex_edu_inc$inc == "Less than $35,000"]="More than $25k"
inc_twolevels[sex_edu_inc$inc == "Less than $25,000"|sex_edu_inc$inc == "Less than $20,000"
|sex_edu_inc$inc == "Less than $15,000"|sex_edu_inc$inc == "Less than $10,000"]="Less than $25k"
sex_edu_inc = sex_edu_inc%>%mutate(inc_twolevels)
sex_edu_inc = sex_edu_inc %>% group_by(edu,sex,inc_twolevels)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
print(data.frame(Edu = sex_edu_inc$edu,Sex = sex_edu_inc$sex,Income = sex_edu_inc$inc_twolevels,Proportions = sex_edu_inc$prop))
ggplot(sex_edu_inc, aes(x=sex, fill = inc_twolevels,group=inc_twolevels)) +
geom_bar(position = 'fill') + facet_wrap( ~ edu, ncol=2)
sex_edu_inc = data.frame(edu = as.factor(brfss2013$educa),inc=as.factor(brfss2013$income2),sex=as.factor(brfss2013$sex))
sex_edu_inc = sex_edu_inc %>% filter(!is.na(inc),!is.na(edu),!is.na(sex))
#levels(sex_edu_inc$edu)[levels(sex_edu_inc$edu)=="College 1 year to 3 years (Some college or technical school)"] = "College 1 year to 3 years"
inc_twolevels = factor(rep(NA,length(sex_edu_inc$inc)),levels = c("Less than $25k","More than $25k"))
inc_twolevels[sex_edu_inc$inc == "Less than $75,000"|sex_edu_inc$inc =="$75,000 or more"
|sex_edu_inc$inc == "Less than $50,000"|sex_edu_inc$inc == "Less than $35,000"]="More than $25k"
inc_twolevels[sex_edu_inc$inc == "Less than $25,000"|sex_edu_inc$inc == "Less than $20,000"
|sex_edu_inc$inc == "Less than $15,000"|sex_edu_inc$inc == "Less than $10,000"]="Less than $25k"
sex_edu_inc = sex_edu_inc%>%mutate(inc_twolevels)
sex_edu_inc = sex_edu_inc %>% group_by(edu,sex,inc_twolevels)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
print(data.frame(Edu = sex_edu_inc$edu,Sex = sex_edu_inc$sex,Income = sex_edu_inc$inc_twolevels,Proportions = sex_edu_inc$prop))
ggplot(sex_edu_inc, aes(x=sex, fill = inc_twolevels,group=inc_twolevels)) +
geom_bar(position = 'fill') + facet_wrap( ~ edu, ncol=2)
sex_edu_inc = data.frame(edu = as.factor(brfss2013$educa),inc=as.factor(brfss2013$income2),sex=as.factor(brfss2013$sex))
sex_edu_inc = sex_edu_inc %>% filter(!is.na(inc),!is.na(edu),!is.na(sex))
nc_twolevels = factor(rep(NA,length(sex_edu_inc$inc)),levels = c("Less than $25k","More than $25k"))
inc_twolevels[sex_edu_inc$inc == "Less than $75,000"|sex_edu_inc$inc =="$75,000 or more"
|sex_edu_inc$inc == "Less than $50,000"|sex_edu_inc$inc == "Less than $35,000"]="More than $25k"
inc_twolevels[sex_edu_inc$inc == "Less than $25,000"|sex_edu_inc$inc == "Less than $20,000"
|sex_edu_inc$inc == "Less than $15,000"|sex_edu_inc$inc == "Less than $10,000"]="Less than $25k"
sex_edu_inc = sex_edu_inc%>%mutate(inc_twolevels)
sex_edu_inc = sex_edu_inc %>% group_by(edu,sex,inc_twolevels)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
ggplot(sex_edu_inc, aes(x=sex, fill = inc_twolevels,group=inc_twolevels)) +
geom_bar(position = 'fill') + facet_wrap( ~ edu, ncol=2)
sex_edu_inc
sex_edu_inc
sex_edu_inc = data.frame(edu = as.factor(brfss2013$educa),inc=as.factor(brfss2013$income2),sex=as.factor(brfss2013$sex))
sex_edu_inc = sex_edu_inc %>% filter(!is.na(inc),!is.na(edu),!is.na(sex))
#levels(sex_edu_inc$edu)[levels(sex_edu_inc$edu)=="College 1 year to 3 years (Some college or technical school)"] = "College 1 year to 3 years"
inc_twolevels = factor(rep(NA,length(sex_edu_inc$inc)),levels = c("Less than $25k","More than $25k"))
inc_twolevels[sex_edu_inc$inc == "Less than $75,000"|sex_edu_inc$inc =="$75,000 or more"
|sex_edu_inc$inc == "Less than $50,000"|sex_edu_inc$inc == "Less than $35,000"]="More than $25k"
inc_twolevels[sex_edu_inc$inc == "Less than $25,000"|sex_edu_inc$inc == "Less than $20,000"
|sex_edu_inc$inc == "Less than $15,000"|sex_edu_inc$inc == "Less than $10,000"]="Less than $25k"
sex_edu_inc = sex_edu_inc%>%mutate(inc_twolevels)
ggplot(sex_edu_inc, aes(x=sex, fill = inc_twolevels,group=inc_twolevels)) +
geom_bar(position = 'fill') + facet_wrap( ~ edu, ncol=2)
summarise_sex_edu_inc = sex_edu_inc %>% group_by(edu,sex,inc_twolevels)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
print(data.frame(Edu = summarise_sex_edu_inc$edu,Sex = summarise_sex_edu_inc$sex,
Income = summarise_sex_edu_inc$inc_twolevels,
Proportions = summarise_sex_edu_inc$prop))
men_phy_sex = data.frame(sex = as.factor(brfss2013$income2),men=brfss2013$menthlth,phy=brfss2013$physhlth)
men_phy_sex = men_phy_sex %>% filter(!is.na(inc),!is.na(men),!is.na(phy))
men_phy_sex = data.frame(inc = as.factor(brfss2013$income2),men=brfss2013$menthlth,phy=brfss2013$physhlth)
men_phy_sex = men_phy_sex %>% filter(!is.na(inc),!is.na(men),!is.na(phy))
inc_twolevels = factor(rep(NA,length(men_phy_sex$inc)),levels = c("Less than $25k","More than $25k"))
inc_twolevels[men_phy_sex$inc == "Less than $75,000"|men_phy_sex$inc =="$75,000 or more"
|men_phy_sex$inc == "Less than $50,000"|men_phy_sex$inc == "Less than $35,000"]="More than $25k"
inc_twolevels[men_phy_sex$inc == "Less than $25,000"|men_phy_sex$inc == "Less than $20,000"
|men_phy_sex$inc == "Less than $15,000"|men_phy_sex$inc == "Less than $10,000"]="Less than $25k"
men_phy_sex = men_phy_sex%>%mutate(inc_twolevels)
gr = men_phy_sex %>% group_by(phy,inc_twolevels) %>% summarise(mean_men = mean(men))
ggplot(gr,aes(x=phy,y=mean_men,colour=))+  geom_point(alpha=0.3) + facet_wrap( ~ sex, ncol=2)
ggplot(gr,aes(x=phy,y=mean_men,colour=inc_twolevels))+  geom_point(alpha=0.3) + facet_wrap( ~ sex, ncol=2)
ggplot(gr,aes(x=phy,y=mean_men,colour=inc_twolevels))+  geom_point(alpha=0.3) + facet_wrap( ~ inc_twolevels, ncol=2)
gr = men_phy_sex %>% group_by(phy,inc_twolevels) %>% summarise(mean_men = mean(men))
poor = gr%>%filter(inc_twolevels=="Less than $25k")
rich = gr%>%filter(sex=="More than $25k")
data.frame(phy=poor$phy,mean_men_poor = poor$mean_men,
mean_men_rich=rich$mean_men)
gr = men_phy_sex %>% group_by(phy,inc_twolevels) %>% summarise(mean_men = mean(men))
poor = gr%>%filter(inc_twolevels=="Less than $25k")
rich = gr%>%filter(inc_twolevels=="More than $25k")
data.frame(phy=poor$phy,mean_men_poor = poor$mean_men,
mean_men_rich=rich$mean_men)
men_phy_sex = data.frame(inc = as.factor(brfss2013$income2),men=brfss2013$menthlth,phy=brfss2013$physhlth)
men_phy_sex = men_phy_sex %>% filter(!is.na(inc),!is.na(men),!is.na(phy))
inc_twolevels = factor(rep(NA,length(men_phy_sex$inc)),levels = c("Less than $25k","More than $25k"))
inc_twolevels[men_phy_sex$inc == "Less than $75,000"|men_phy_sex$inc =="$75,000 or more"
|men_phy_sex$inc == "Less than $50,000"|men_phy_sex$inc == "Less than $35,000"]="More than $25k"
inc_twolevels[men_phy_sex$inc == "Less than $25,000"|men_phy_sex$inc == "Less than $20,000"
|men_phy_sex$inc == "Less than $15,000"|men_phy_sex$inc == "Less than $10,000"]="Less than $25k"
men_phy_sex = men_phy_sex%>%mutate(inc_twolevels)
gr = men_phy_sex %>% group_by(phy,inc_twolevels) %>% summarise(mean_men = mean(men))
poor = gr%>%filter(inc_twolevels=="Less than $25k")
rich = gr%>%filter(inc_twolevels=="More than $25k")
data.frame(phy=poor$phy,mean_men_poor = poor$mean_men,
mean_men_rich=rich$mean_men)
ggplot(gr,aes(x=phy,y=mean_men,colour=inc_twolevels))+  geom_point(alpha=0.3) + facet_wrap( ~ inc_twolevels, ncol=2)
inc_twolevels = factor(rep(NA,length(brfss2013$inc)),levels = c("Less than $25k","More than $25k"))
inc_twolevels[brfss2013$inc == "Less than $75,000"|brfss2013$inc =="$75,000 or more"
|brfss2013$inc == "Less than $50,000"|brfss2013$inc == "Less than $35,000"]="More than $25k"
inc_twolevels = factor(rep(NA,length(brfss2013$inc)),levels = c("Less than $25k","More than $25k"))
inc_twolevels[brfss2013$inc == "Less than $75,000"|brfss2013$inc =="$75,000 or more"
|brfss2013$inc == "Less than $50,000"|brfss2013$inc == "Less than $35,000"]="More than $25k"
inc_twolevels[brfss2013$inc == "Less than $25,000"|brfss2013$inc == "Less than $20,000"
|brfss2013$inc == "Less than $15,000"|brfss2013$inc == "Less than $10,000"]="Less than $25k"
men_phy_sex = data.frame(inc = inc_twolevels,men=brfss2013$menthlth,phy=brfss2013$physhlth)
men_phy_sex = men_phy_sex %>% filter(!is.na(inc),!is.na(men),!is.na(phy))
men_phy_sex = men_phy_sex%>%mutate(inc_twolevels)
men_phy_sex = data.frame(inc = inc_twolevels,men=brfss2013$menthlth,phy=brfss2013$physhlth)
men_phy_sex = men_phy_sex %>% filter(!is.na(inc),!is.na(men),!is.na(phy))
gr = men_phy_sex %>% group_by(phy,inc_twolevels) %>% summarise(mean_men = mean(men))
inc_twolevels = factor(rep(NA,length(brfss2013$inc)),levels = c("Less than $25k","More than $25k"))
inc_twolevels[brfss2013$inc == "Less than $75,000"|brfss2013$inc =="$75,000 or more"
|brfss2013$inc == "Less than $50,000"|brfss2013$inc == "Less than $35,000"]="More than $25k"
inc_twolevels[brfss2013$inc == "Less than $25,000"|brfss2013$inc == "Less than $20,000"
|brfss2013$inc == "Less than $15,000"|brfss2013$inc == "Less than $10,000"]="Less than $25k"
men_phy_sex = data.frame(inc = inc_twolevels,men=brfss2013$menthlth,phy=brfss2013$physhlth)
men_phy_sex = men_phy_sex %>% filter(!is.na(inc),!is.na(men),!is.na(phy))
inc_twolevels = factor(rep(NA,length(brfss2013$inc)),levels = c("Less than $25k","More than $25k"))
inc_twolevels[brfss2013$inc == "Less than $75,000"|brfss2013$inc =="$75,000 or more"
|brfss2013$inc == "Less than $50,000"|brfss2013$inc == "Less than $35,000"]="More than $25k"
inc_twolevels[brfss2013$inc == "Less than $25,000"|brfss2013$inc == "Less than $20,000"
|brfss2013$inc == "Less than $15,000"|brfss2013$inc == "Less than $10,000"]="Less than $25k"
men_phy_sex = data.frame(inc = inc_twolevels,men=brfss2013$menthlth,phy=brfss2013$physhlth)
men_phy_sex = men_phy_sex %>% filter(!is.na(inc),!is.na(men),!is.na(phy))
gr = men_phy_sex %>% group_by(phy,inc) %>% summarise(mean_men = mean(men))
poor = gr%>%filter(inc=="Less than $25k")
rich = gr%>%filter(inc=="More than $25k")
data.frame(phy=poor$phy,mean_men_poor = poor$mean_men,
mean_men_rich=rich$mean_men)
ggplot(gr,aes(x=phy,y=mean_men,colour=inc))+  geom_point(alpha=0.3) + facet_wrap( ~ inc, ncol=2)
sex_edu_inc = data.frame(edu = as.factor(brfss2013$educa),inc=inc_twolevels,sex=as.factor(brfss2013$sex))
sex_edu_inc = sex_edu_inc %>% filter(!is.na(inc),!is.na(edu),!is.na(sex))
ggplot(sex_edu_inc, aes(x=sex, fill = inc,group=inc)) +
geom_bar(position = 'fill') + facet_wrap( ~ edu, ncol=2)
summarise_sex_edu_inc = sex_edu_inc %>% group_by(edu,sex,inc)%>%summarise(n = n()) %>% mutate(prop = n/sum(n))
print(data.frame(Edu = summarise_sex_edu_inc$edu,Sex = summarise_sex_edu_inc$sex,
Income = summarise_sex_edu_inc$inc,
Proportions = summarise_sex_edu_inc$prop))
gym_wei_hei = data.frame(gym = brfss2013$exerany2,wei=as.numeric(brfss2013$weight2),hei=as.numeric(brfss2013$height3)/10)
gym_wei_hei = gym_wei_hei %>% filter(!is.na(gym),!is.na(wei),!is.na(hei))
gym_wei_hei = gym_wei_hei %>% mutate(bmi = 703*gym_wei_hei$wei/(gym_wei_hei$hei)^2)
body_cat = factor(rep(NA,length(bmi)),levels = c("Underweight","Normal","Overweight","Obese/Moderately Obese","Severely/Morbidly Obese"))
body_cat[gym_wei_hei$bmi<=18.5] = "Underweight"
body_cat[gym_wei_hei$bmi>18.5 & gym_wei_hei$bmi<=25] = "Normal"
body_cat[gym_wei_hei$bmi>25 & gym_wei_hei$bmi<=27] = "Overweight"
body_cat[gym_wei_hei$bmi>27 & gym_wei_hei$bmi<=35] = "Obese/Moderately Obese"
body_cat[gym_wei_hei$bmi>35] = "Severely/Morbidly Obese"
gym_wei_hei = gym_wei_hei %>% mutate(body_cat)
ggplot(gym_wei_hei,aes(x=gym,fill=body_cat))+geom_bar(position="fill")
gym_wei_hei_summarise = gym_wei_hei %>% group_by(gym,body_cat)%>%summarise(n=n())%>%mutate(prop = n/sum(n))
gym_wei_hei_summarise
print(data.frame(Gym = gym_wei_hei_summarise$gym,Body_cat = gym_wei_hei_summarise$body_cat
,Proportion=gym_wei_hei_summarise$prop))
gym_wei_hei = data.frame(gym = brfss2013$exerany2,wei=as.numeric(brfss2013$weight2),hei=as.numeric(brfss2013$height3)/10)
gym_wei_hei = gym_wei_hei %>% filter(!is.na(gym),!is.na(wei),!is.na(hei))
gym_wei_hei = gym_wei_hei %>% mutate(bmi = 703*gym_wei_hei$wei/(gym_wei_hei$hei)^2)
body_cat = factor(rep(NA,length(bmi)),levels = c("Underweight","Normal","Overweight","Obese/Moderately Obese","Severely/Morbidly Obese"))
body_cat[gym_wei_hei$bmi<=18.5] = "Underweight"
body_cat[gym_wei_hei$bmi>18.5 & gym_wei_hei$bmi<=25] = "Normal"
body_cat[gym_wei_hei$bmi>25 & gym_wei_hei$bmi<=27] = "Overweight"
body_cat[gym_wei_hei$bmi>27 & gym_wei_hei$bmi<=35] = "Obese/Moderately Obese"
body_cat[gym_wei_hei$bmi>35] = "Severely/Morbidly Obese"
gym_wei_hei = gym_wei_hei %>% mutate(body_cat)
gym_wei_hei_summarise = gym_wei_hei %>% group_by(gym,body_cat)%>%summarise(n=n())%>%mutate(prop = n/sum(n))
print(data.frame(Gym = gym_wei_hei_summarise$gym,Body_cat = gym_wei_hei_summarise$body_cat
,Proportion=gym_wei_hei_summarise$prop))
ggplot(gym_wei_hei,aes(x=gym,fill=body_cat))+geom_bar(position="fill")
gym_wei_hei = data.frame(gym = brfss2013$exerany2,wei=as.numeric(brfss2013$weight2),hei=as.numeric(brfss2013$height3)/10)
gym_wei_hei = gym_wei_hei %>% filter(!is.na(gym),!is.na(wei),!is.na(hei))
gym_wei_hei = gym_wei_hei %>% mutate(bmi = 703*gym_wei_hei$wei/(gym_wei_hei$hei)^2)
body_cat = factor(rep(NA,length(bmi)),levels = c("Underweight","Normal","Overweight","Obese/Moderately Obese","Severely/Morbidly Obese"))
body_cat[gym_wei_hei$bmi<=18.5] = "Underweight"
body_cat[gym_wei_hei$bmi>18.5 & gym_wei_hei$bmi<=25] = "Normal"
body_cat[gym_wei_hei$bmi>25 & gym_wei_hei$bmi<=27] = "Overweight"
body_cat[gym_wei_hei$bmi>27 & gym_wei_hei$bmi<=35] = "Obese/Moderately Obese"
body_cat[gym_wei_hei$bmi>35] = "Severely/Morbidly Obese"
gym_wei_hei = gym_wei_hei %>% mutate(body_cat)
gym_wei_hei_summarise = gym_wei_hei %>% group_by(gym,body_cat)%>%summarise(n=n())%>%mutate(prop = n/sum(n))
print(data.frame(Gym = gym_wei_hei_summarise$gym,Body_cat = gym_wei_hei_summarise$body_cat
,Proportion=gym_wei_hei_summarise$prop))
ggplot(gym_wei_hei,aes(x=gym,fill=body_cat))+geom_bar(position="fill")
body_cat = factor(rep(NA,length(bmi)),levels = c("Underweight","Normal","Overweight","Obese/Moderately Obese","Severely/Morbidly Obese"))
system('echo $PATH')
system('echo $PATH')
system('echo $PATH')
system('echo $PATH')
vim .bash_profile
system('echo $PATH')
system('echo $PATH')
system('echo $PATH')
system('echo $PATH')
rm(list=objects())
library(mgcv)
library(date)
import(date)
install.packages("date")
rm(list=objects())
library(mgcv)
library(date)
install.packages("mgcv")
install.packages("mgcv")
library(mgcv)
library(date)
chemin<-"./DONNEES US/"
fich<-"data_elec0.txt"
Data0<-read.table(paste(chemin,fich,sep=""),sep='\t',header=TRUE,dec='.')
fich<-"data_elec0.txt"
Data0<-read.table(fich,sep='\t',header=TRUE,dec='.')
fich<-"./data_elec0.txt"
Data0<-read.table(fich,sep='\t',header=TRUE,dec='.')
fich<-"./data_elec0.txt"
Data0<-read.table(fich,sep='\t',header=TRUE,dec='.')
fich<-".\data_elec0.txt"
Data0<-read.table(fich,sep='\t',header=TRUE,dec='.')
fich<-"./data_elec0.txt"
read.table(fich,sep='\t',header=TRUE,dec='.')
getwd()
source('~/Desktop/DONNEES US/projet.R')
install.packages("date")
getwd()
setwd(.)
setwd(".")
getwd()
source('~/Desktop/DONNEES US/projet.R')
source('~/Desktop/DONNEES US/projet.R')
install.packages("date")
getwd()
setwd("~/Desktop/DONNEES US")
fich<-"./data_elec0.txt"
Data0<-read.table(fich,sep='\t',header=TRUE,dec='.')
Data0<-read.table("./data_elec0.txt",sep='\t',header=TRUE,dec='.')
Data1<-read.table(paste("data_elec1.txt",fich,sep=""),sep='\t',header=TRUE,dec='.')
source('~/Desktop/DONNEES US/projet.R')
Data0<-read.table("data_elec0.txt",sep='\t',header=TRUE,dec='.')
Data1<-read.table(paste("data_elec1.txt",fich,sep=""),sep='\t',header=TRUE,dec='.')
